<?php

  // This code example uses the PHP Media API wrapper
  // For the PHP Media API wrapper, visit opensource.brightcove.com

	// Include the BCMAPI SDK
	require('bc-mapi.php'); 
	// Include the Smarty templating system
  // for more info: http://www.smarty.net/
  require_once('Smarty.class.php');
	// instantiate smarty
	$smarty = new smarty();
	// set smarty directories
	$smarty->setTemplateDir('smarty/templates/');
  $smarty->setCompileDir('smarty/templates_c/');
  $smarty->setCacheDir('smarty/cache/');
  $smarty->setConfigDir('smarty/configs/');

	// Instantiate the class, passing it our Brightcove API tokens (read, then write)
	$bc = new BCMAPI(
	  'WDGO_XdKqXVJRVGtrNuGLxCYDNoR-SvA5yUqX2eE6KjgefOxRzQilw..',
	  'Jyiei-T0_tDMwct8bUns819VTkfvkt9iX2mnIfkc8GNnREmW2YTG6A..'
	);
  // Define our parameters
  $params = array(
    'video_fields' => 'id,name,shortDescription,tags'
  );
  // Set our search terms
    $terms = array(
  );
  // Make our API call
  $videos = $bc->search('video', $terms, $params);
  // assign the data to smarty
  $smarty->assign('videos' , $videos);
  // set the filename
  $sitemapfile = 'sitemap.xml';
  // generate the sitemap populated with data
  // $smarty->display('MediaAPI_ex3_sitemap.tpl');
  $sitemap = $smarty->fetch('MediaAPI_ex3_sitemap.tpl', $cache_id);
  $filelength =  file_put_contents($sitemapfile, $sitemap);
 echo("Sitemap created successfully.");
?>
